package br.com.ecoffee.factory.pedido;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

import br.com.ecoffee.model.carrinho.Carrinho;
import br.com.ecoffee.model.endereco.Endereco;
import br.com.ecoffee.model.produto.Produto;
import br.com.ecoffee.service.carrinho.CarrinhoDeCompraService;
import br.com.ecoffee.service.endereco.EnderecoService;

public class PedidoFactory {
	
	private CarrinhoDeCompraService carrinhoService;
	private EnderecoService enderecoService;
	
	public List<Pedido> criarPedido(Long idCliente, Long idEndereco) {
		
		List<Pedido> pedidos = new ArrayList<>();
		
		List<Carrinho> carrinhos = carrinhoService.buscarCarrinhoPeloIdCliente(idCliente);
		Endereco endereco = enderecoService.buscarEnderecoPeloId(idEndereco).get();
		
		for(Carrinho car : carrinhos) {
			
			Produto produto = car.getProduto();
			
			Double valorTotal = car.getQuantidade() * produto.getPreco().doubleValue();
			
			new Pedido(car.getQuantidade(), LocalDate.now(), valorTotal, car.getCliente(), endereco, produto);
			
		}
	}

}
